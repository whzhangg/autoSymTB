\documentclass{article}
\usepackage{amssymb, amsmath, amsthm}
\usepackage[margin=1in]{geometry}
\usepackage{verbatim}
\usepackage{graphicx}
\usepackage{hyperref} % \url \href

\newtheorem{definition}{Definition}
\newtheorem{theorem}{Theorem}
\DeclareMathOperator{\spn}{Span}

\begin{document}

\title{Molecular orbitals and symmetrization}
\author{Wenhao Zhang}
\date{\today}
\maketitle

\section{Introduction}

It is inefficient to learn rules using try and error, while the rules can be 
simply stated. 
Similarly, if we want to achieve the best results using machine learning, which 
basically learn from statistic distribution of data, 
it is important that we include as much concrete rules as possible. 
This should greatly improve the accuracy of ML prediction while simplify the 
problems for ML so that fewer data are necessary.
To let machines predict the electronic structure of moleculars, for example, the 
energy levels of the electronic states, 
one way is to input the molecular structure to ML and ask it to output the energies. 
However, this naive approach suffer from the problems that 1) this `ab-initio' approach
is too complicated to be formulated as a single function that we can hopefully understand 
and 2) since we ourselves cannot understand it, it is impossible for us to inspect the 
machine learning model: is machine really learning anything important, or it just 
found some other patterns that fits the data but does not agree with our physical 
or chemical understanding. 

Using results from group theory, it is possible to simplify the Hamiltonians of 
a molecular systems. Such approach utilize the symmetry of moleculars and provide
rules that quantum mechanical interactions have to obey. 
For example, a `s' type wavefunction can not interact with the `p' type wavefunction,
because their intergrals are strictly zero. 
Furthermore, using group theory analysis using only symmetry information, we can find 
our the degeneracy that are exact. 
These informations reduce the size of the problem considerably. As a consequence, to 
find the energy of the states, we now only need to consider the remaining interactions 
that are allowed with the know form of the states, and the problem is then largely 
an electro-static one, which should be simple enough for machine learning to solve.
We try to formulate the ideas in the following sections

\section{Groups, representations and basis}
\subsection{Groups and representations}
The symmetry operation that map a molecular onto itself form a group $G$. From a group,
we define a representation of group $G$ as a mapping:
\begin{definition}
    A linear \emph{representation} of a group $G$ on a vector space $V$ is a homomorphism:
    \[\rho\colon G \to \text{GL}(V)\]
    where homomorphism is a mapping that satisfies $\rho(g_1g_2) = \rho(g_1)\rho(g_2)$.
\end{definition}
Representations are not unique: a change of basis leads to an equivalent representation 
and the direct sum of two representation is again a representation. However, representations
can be uniquely reduced to so called \emph{irreducible representations}.
We define the notion of \emph{invariant vector space}:
\begin{definition}
    For any vector $v$ in $V$, for any $g\in G$, if we have $\rho(g)v \in V$, then $V$
    is an invariant vector space.
\end{definition} 
For a representation with vector space $V$, $V$ is an invariant to the group $G$. 
If there exist a vector space $W\subset V$ which is also invariant to $G$, then we call $W$
an \emph{invariant subspace}. 
Furthermore, there exist another invariant subspace $U$ of $V$ so that $V$ is given by a direct sum:
\begin{equation}
    V = U \oplus W
\end{equation}
By splitting the vector space $V$ into invariant subspaces until it is not possible, we find the 
\emph{irreducible representation} by the reducible representation on $V$, and the matrix form 
of the reducible representation can be written as the block diagonal form
\begin{equation}
    \rho^{\Gamma}(g) = \left(  
        \begin{matrix}
            \rho^{\Gamma_1} (g) & 0 & \cdots\\
            0 & \rho^{\Gamma_2} (g) & \\
            \vdots &  & \ddots
        \end{matrix}
    \right)
\end{equation}
where $\Gamma$ denote the reducible representation and $\Gamma_i\ (i = 1, \dots)$ index 
the irreducible representations.

\subsection{Basis functions}
For each invariant subspaces corresponding to a representation $\Gamma_n$, we write its basis 
functions using the braket notation $|\Gamma_n,j\rangle$. For a irreducible representation with 
dimension $N$, we have $N$ such basis functions and any vectors in this invariant subspace 
can be written as a linear combination:
\begin{equation}
    |\phi^{\Gamma_n}\rangle = \sum_{i = 1}^N c_i |\Gamma_n,i\rangle
\end{equation} 
Due to the definition of invariant subspace, the matrix representation of $G$ in the invariant 
subspace will have the form:
\begin{equation}
    \rho^{\Gamma_n}(g)_{ij} = \langle \Gamma_n,i | P_g | \Gamma_n,j \rangle
\end{equation}
where $P_g$ is the symmetry operation. 
For reducible representations $\Gamma_{r}$, its vector subspace is a direct sum of all the subspace 
of irreducible representations it contains. Therefore, basis functions from irreducible 
subspaces together form the basis functions for the reducible representation.

The basis functions of the representation of the symmetry group is closely connected to quantum mechanics.
Since the Hamiltonian of the system is invariant to the symmetry operation, we have the commutation 
relationship:
\begin{equation}
    [P_g,H] = 0
\end{equation}
for any symmetry operation $g$. As a consequence, if $|\phi_{\varepsilon_i}\rangle$ an eigenfunction of $H$
with eigenvalue $\varepsilon_i$, $P_g|\phi_{\varepsilon_i}\rangle$ will also be an eigenfunction 
with degenerate eigenvalues. Since $|\phi_{\varepsilon_i}\rangle$ and $P_g|\phi_{\varepsilon_i}\rangle$
together will define some invariant space. Therefore, it is possible to classify the eigenfunctions of the 
Hamiltonian according to the subspaces which they occupy, and the set of degenerate eigenfunctions are 
related by symmetry operation. 

\section{Finding the representations and Symmetry adopted basis functions}
\subsection{Molecular orbitals}
Using character table and the orthogonality theorem for characters, we can find the basis functions 
of the Hamiltonians knowing only the symmetry property of the structure. 
We start by finding the vector space of all the participating atomic orbitals and their transformation 
properties under group operation, then decompose the reducible representation to irreducible ones. 
We follow the example of Dresselhaus\cite{Dresselhaus2008} and consider the group $D_{3h}$ with 
the following character table \ref{T:ct}
\begin{table}[h!]
    \centering
    \caption{Character table of $D_{3h}$}
    \begin{tabular}{|c|c|c|c|c|c|c|}
                & $E$ & $\sigma_h$ & 2$C_3$ & 2$S_3$ & 2$C_2'$ & 3$\sigma_v$ \\ \hline
         $A_1'$ &  1  &  1         &  1     &  1     &   1     &   1         \\
         $A_2'$ &  1  &  1         &  1     &  1     &  -1     &  -1         \\
         $A_1''$&  1  & -1         &  1     & -1     &   1     &  -1         \\
         $A_2''$&  1  & -1         &  1     & -1     &  -1     &   1         \\
         $E'$   &  2  &  2         &  -1    & -1     &   0     &   0         \\
         $E''$  &  2  & -2         &  -1    &  1     &   0     &   0         \\ \hline
    \end{tabular}
    \label{T:ct}
\end{table}
Suppose we have four atoms, one on the rotation axis and three other that transform to each other 
by three fold rotation, and $s$ and $p$ orbitals on each of the atoms. Indexing each atomic 
centered functions using atomic index $i$ and orbital index $l,m$ as $| i,l,m \rangle$ 
(or $| i,s \rangle, \dots, |i,p_x\rangle$ if convenient), we form 
a vector space with dimension $4\times4 = 16$:
\begin{equation}
    V = \spn(| 1,s \rangle, | 1,p_x \rangle ,\dots, | 4,p_y \rangle, | 4,p_z \rangle)
\end{equation}
We can find the matrix elements of the symmetry group in this space using the following equation:
\begin{equation}
    \rho(g)_{ij} = \langle i | P_g | j \rangle
\end{equation}
where $\rho(g)$ is the matrix in the vector space of atomic basis function and $P_g$ is the 
operators that transform the basis functions. 
After generating the matrix of each symmetry operation, we find the character of the representation
in this atomic orbital basis:
\begin{gather*}
    \chi^{AOs}(E) = 16,\ \chi^{AOs}(\sigma_h) = 8,\ \chi^{AOs}(C_3) = 1\\ 
    \chi^{AOs}(S_3) = -1,\ \chi^{AOs}(C_2') = 0,\ \chi^{AOs}(\sigma_v) = 4
\end{gather*}
The uniqe decomposition of the reducible representation into the irreducible ones are given by:
\begin{gather}
    \chi(C_k) = \sum_{\Gamma_i} a_i \chi^{\Gamma_i}(C_k) \\
    a_i = \frac{1}{h} \sum_{k} N_k \chi^{\Gamma_i}(C_k)^* \chi(C_k)
\end{gather}
where $C_k$ and $N_k$ denote the class of symmetry operation (whose elements have the same character)
and their multiplicity. $h = |G|$ is the order of the group. Decomposing the 
above represention in atomic orbital space, we obtain the following relationship:
\begin{equation}
    \Gamma^{AOs} = 
      3\Gamma^{A_1'} + \Gamma^{A_2'}  + 2\Gamma^{A_2''} + 4\Gamma^{E'} + \Gamma^{E''}
\end{equation}

\subsection{Symmetry adopted linear combination}
Knowing who the vector space constructed from the atomic orbitals can be organized into invariant subspaces 
under symmetry group does not tell us what these subspaces are. 
More importantly, to start to reason about the energy of these orbitals, we should start from the approximate
shape of these orbitals.

To start, we first identify what these subspaces are using the projection operation on the atomic basis functions
\begin{equation}
    P^{\Gamma_i} = \frac{l_n}{h}\sum_R \chi^{\Gamma_i}(R) P_R
\end{equation}
where $P^{\Gamma_i}$ is the projection operation onto the representation $\Gamma_i$, $l_n$ is the dimension of the 
representation. 
Operating this projection operator on an arbitrary function in the vector space $V^{AOs}$ produce a vector in the 
subspace that correspond to the required representation. In our previous example, 
if we consider the vector subspace formed by the $s$ orbital centered on three equivalent atoms corresponding to the 
corner of the triangle, the group representation can be decomposed to $\Gamma^{s3} = \Gamma^{A_1'} + \Gamma^{E'}$
with dimension one and two. 
Projecting from each of the $s$ function onto these subspaces, we find that, for $A_1'$:
\begin{align}
    \psi_1^{A_1'} = \frac{1}{3}|s,1\rangle + \frac{1}{3}|s,2\rangle + \frac{1}{3}|s,3\rangle 
    = \psi_2^{A_1'} = \psi_3^{A_1'}
\end{align}
i.e., the projectioned functions span a one dimensional subspace. 
For $E'$ which is a two dimensional subspace, projection gives:
\begin{align}
    \psi_1^{E'} &= \ \ \ \frac{2}{3}|s,1\rangle - \frac{1}{3}|s,2\rangle - \frac{1}{3}|s,3\rangle  \\
    \psi_2^{E'} &= -\frac{1}{3}|s,1\rangle + \frac{2}{3}|s,2\rangle - \frac{1}{3}|s,3\rangle  \\
    \psi_3^{E'} &= -\frac{1}{3}|s,1\rangle - \frac{1}{3}|s,2\rangle + \frac{2}{3}|s,3\rangle 
\end{align}
Noting that $\psi_3^{E'} = - (\psi_1^{E'} + \psi_2^{E'})$, we find that this is indeed a two dimension 
subspace. 

Finally, we discuss how to generate the basis functions in these linear subspace that suite our need. We do not 
require orthogonality for the basis functions, but require that basis functions are related to each other by 
symmetry transformations. 


\begin{thebibliography}{99}
    \bibitem{Dresselhaus2008} 
    Dresselhaus, M. S.; Dresselhaus, G.; Jorio, A. Group Theory: Application to the Physics of Condensed Matter; Springer-Verlag: Berlin, 2008.
\end{thebibliography}

\appendix 
% on the same page, section is numberd with A, B automatically
\section{}


\end{document}
